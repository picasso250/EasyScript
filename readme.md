# EasyScript 脚本语言：设计与哲学

## 简介

**EasyScript** 是一种为追求极致**简洁**、**易学**和**结构清晰**而设计的脚本语言。在新版本中，它完全采纳了 **“一切皆表达式” (Everything is an Expression)** 的设计哲学，具备现代编程所需的所有核心功能，但通过消除“语句”和“表达式”之间的概念鸿沟，将语言的**语义统一性**提升到极致。

**EasyScript** 的目标是成为初学者的完美**基石**语言，让学习者能专注于算法逻辑和数据流，而非记忆复杂的语法和优先级规则。

## 核心设计哲学：一切皆表达式 (Everything is an Expression)

EasyScript 的设计围绕两大核心原则：

### 1. 极致的语义统一性 (Expression-Oriented)

*   **无语句 (No Statements)：** 语言中**没有 `Statement` 概念**。`if` 结构、`for` 结构、`函数定义`，甚至**赋值**，全部都是表达式 (`Expression`)。
*   **隐式返回 (Implicit Return)：** 函数体 (`BlockExpression`) 的返回值由其内部**最后一个表达式**的值决定。显式的 `return` 关键字已被移除。
*   **副作用标记：** 表达式后加上分号 `;` 表示这是一个带有**副作用** (如赋值、打印) 的表达式，它的返回值会被忽略，并隐式返回 **`nil`**。

### 2. 结构化与空值哲学 (`nil` 值与强类型运行时)

*   **空值哲学 (`nil`)：** 引入一个统一的 **`nil`** 值。
    *   `nil` 用于表示变量未赋值、字典查找失败。
    *   `nil` **同时承担了 `unit/void` 的语义**，作为所有带有副作用的表达式（如 `a = 1;`）或缺少返回值分支的表达式（如无 `else` 的 `if`）的返回值。
*   **强类型运行时 (Strongly Typed Runtime)**：EasyScript 奉行强类型原则，运行时不会在不同类型之间进行隐式转换。
    *   **`+` 运算符的哲学**：`+` 运算符用于“连接”或“相加”两个**相同类型**的容器或值。它不会对不同类型进行隐式转换。
        *   **数字 + 数字**：执行数学加法。
        *   **字符串 + 字符串**：执行字符串拼接。
        *   **列表 + 列表**：执行列表拼接，返回一个包含两个列表所有元素的新列表。
        *   **任何不符合以上规则的操作**（例如 `数字 + 字符串`）都会导致运行时错误。
*   **Go-Style 控制流：** `if` 和 `for` 语句的条件表达式**无需使用圆括号**。
*   **强制表达式块：** `if`, `for`, `fun` 的代码体**必须**是表达式块 `{}` ($\langle \text{BlockExpression} \rangle$)，保证了结构清晰和返回值的一致性。**此外，独立的 `{}` 也是一个 Block 表达式，它是创建局部作用域和封装复杂逻辑的强大工具。**

## 语言核心特性速览

### 控制流 (全部是 Expression)

| 特性 | 示例 (Expression-Style) | 描述 |
| :--- | :--- | :--- |
| **函数定义** | `myFunc = fun(x) { x * x }` | `fun` 定义的表达式返回一个可执行的函数对象。函数体的最后一个表达式作为返回值。 |
*   **声明 (`let`)** | `let myVar = 10;` | `let` 是一个表达式，用于在当前作用域**声明并初始化**一个新变量（实现遮蔽）。它**返回被赋的值**。 |
*   **重新赋值** | `myVar = 20;` 或 `myDict["key"] = 1;` | 重新赋值是一个表达式，**返回 `nil`**。仅能对已存在的变量进行操作，若变量不存在则抛出运行时错误。常以分号 `;` 结尾以表示其主要目的是副作用。 |
| **属性访问/赋值** | `myObj.prop = 1;` 或 `value = myObj.prop;` | `.` 是字典/Map 访问的语法糖。`myObj.prop` 等价于 `myObj["prop"]`。 |
| **方法调用** | `myObj.method(arg1, arg2)` | 像 Lua 一样，`.` 方法调用会自动将 `myObj`（即 `self`）作为第一个参数传入函数。|
| **条件分支** | `result = if a > 10 { 1 } else { 0 };` | `if` 是表达式，返回分支代码块的值。如果无 `else` 且条件不满足，**返回 `nil`**。 |
| **列表转换循环** | `b = for x in a { x + 1 };` | **For Expression** 专用于集合转换（即 `map` 操作）。它遍历集合，收集循环体内最后一个表达式的值，**返回一个新的列表**。 |
| **副作用循环** | `for item in range(0, 10) { sum = sum + item; };` | 如果 `for` 循环的返回值被忽略或赋值给一个变量，它主要用于执行副作用。 |
| **Block 表达式** | `let res = { let x = 10; x * 2; };` | 独立的 Block 表达式是创建局部作用域和封装复杂逻辑的强大工具。它返回其内部最后一个表达式的值。|

### 数据结构

| 特性 | 实现方式 |
| :--- | :--- |
| **空值** | 唯一的 **`nil`** 值，用于表示空值和无意义的返回值 (Unit/Void)。|
| **列表 (List)** | 支持使用字面量 `[1, a+b, true]` 构造。 |
| **字典 (Dict/Map)** | 支持使用键值对字面量 `{"key": 1, 2: "b"}` 构造。 **对象即 Map。**|
| **高优先级访问** | 列表/字典的索引操作 `[ ]` 和属性的点访问 `.` 具有最高的优先级。 |

## 总结

**EasyScript** 的新设计证明了**极简**、**功能强大**和**语义优雅**可以完美共存。通过将整个语言统一到“表达式”的概念下（包括灵活的 Block 表达式），并引入高效的语法糖，我们创建了一个语法更简洁、语义更统一、且完全具备执行任何算法能力的脚本语言。它是学习函数式编程思想和语言设计理念的理想选择。